require('source-map-support').install();

'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _getIterator = require('babel-runtime/core-js/get-iterator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _this5 = this;

var _2 = require('../..');

var _fakeDriver = require('./fake-driver');

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _requestPromise = require('request-promise');

var _requestPromise2 = _interopRequireDefault(_requestPromise);

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

var _httpStatusCodes = require('http-status-codes');

var _httpStatusCodes2 = _interopRequireDefault(_httpStatusCodes);

var _helpers = require('./helpers');

var should = _chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

describe('MJSONWP', function callee$0$0() {
  return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
    var _this = this;

    while (1) switch (context$1$0.prev = context$1$0.next) {
      case 0:

        //TODO: more tests!:
        // Unknown commands should return 404

        describe('direct to driver', function () {
          var d = new _fakeDriver.FakeDriver();
          it('should return response values directly from the driver', function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap(d.setUrl("http://google.com"));

                case 2:
                  context$3$0.sent.should.contain("google");

                case 3:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });
        });

        describe('via express router', function () {
          var mjsonwpServer = undefined;
          var driver = undefined;

          before(function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  driver = new _fakeDriver.FakeDriver();
                  driver.sessionId = 'foo';
                  context$3$0.next = 4;
                  return _regeneratorRuntime.awrap((0, _2.server)((0, _2.routeConfiguringFunction)(driver), 8181));

                case 4:
                  mjsonwpServer = context$3$0.sent;

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          after(function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  mjsonwpServer.close();

                case 1:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should proxy to driver and return valid jsonwp response', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/url',
                    method: 'POST',
                    json: { url: 'http://google.com' }
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.should.eql({
                    status: 0,
                    value: "Navigated to: http://google.com",
                    sessionId: "foo"
                  });

                case 4:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should assume requests without a Content-Type are json requests', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/url',
                    method: 'POST',
                    body: JSON.stringify({ url: 'http://google.com' })
                  }));

                case 2:
                  res = context$3$0.sent;

                  JSON.parse(res).should.eql({
                    status: 0,
                    value: "Navigated to: http://google.com",
                    sessionId: "foo"
                  });

                case 4:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should respond to x-www-form-urlencoded as well as json requests', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/url',
                    method: 'POST',
                    form: { url: 'http://google.com' }
                  }));

                case 2:
                  res = context$3$0.sent;

                  JSON.parse(res).should.eql({
                    status: 0,
                    value: "Navigated to: http://google.com",
                    sessionId: "foo"
                  });

                case 4:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should include url request parameters for methods to use - sessionid', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/back',
                    method: 'POST',
                    json: {},
                    simple: false,
                    resolveWithFullResponse: true
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.body.should.eql({
                    status: 0,
                    value: "foo",
                    sessionId: "foo"
                  });

                case 4:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should include url request parameters for methods to use - elementid', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/element/bar/click',
                    method: 'POST',
                    json: {}
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.status.should.equal(0);
                  res.value.should.eql(["bar", "foo"]);

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should include url req params in the order: custom, element, session', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/element/bar/attribute/baz',
                    method: 'GET',
                    json: {}
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.status.should.equal(0);
                  res.value.should.eql(["baz", "bar", "foo"]);

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should respond with 400 Bad Request if parameters missing', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/url',
                    method: 'POST',
                    json: {},
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(400);
                  res.body.should.contain("url");

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should reject requests with a badly formatted body and not crash', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/url',
                    method: 'POST',
                    json: "oh hello"
                  }).should.eventually.be.rejected);

                case 2:
                  context$3$0.next = 4;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/url',
                    method: 'POST',
                    json: { url: 'http://google.com' }
                  }));

                case 4:
                  res = context$3$0.sent;

                  res.should.eql({
                    status: 0,
                    value: "Navigated to: http://google.com",
                    sessionId: "foo"
                  });

                case 6:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should get 404 for bad routes', function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/blargimarg',
                    method: 'GET'
                  }).should.eventually.be.rejectedWith("404"));

                case 2:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          // TODO pass this test
          // https://github.com/appium/node-mobile-json-wire-protocol/issues/3
          it('4xx responses should have content-type of text/plain', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/blargimargarita',
                    method: 'GET',
                    resolveWithFullResponse: true,
                    simple: false // 404 errors fulfill the promise, rather than rejecting
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.headers['content-type'].should.include('text/plain');

                case 4:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should throw not yet implemented for unfilledout commands', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/element/bar/location',
                    method: 'GET',
                    json: true,
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(501);
                  res.body.should.eql({
                    status: 13,
                    value: {
                      message: 'Method has not yet been implemented'
                    },
                    sessionId: 'foo'
                  });

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should throw not implemented for ignored commands', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/buttonup',
                    method: 'POST',
                    json: {},
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(501);
                  res.body.should.eql({
                    status: 13,
                    value: {
                      message: 'Method is not implemented'
                    },
                    sessionId: 'foo'
                  });

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should get 400 for bad parameters', function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/url',
                    method: 'POST',
                    json: {}
                  }).should.eventually.be.rejectedWith("400"));

                case 2:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should ignore special extra payload params in the right contexts', function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/element/bar/value',
                    method: 'POST',
                    json: { id: 'baz', sessionId: 'lol', value: ['a'] }
                  }));

                case 2:
                  context$3$0.next = 4;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/element/bar/value',
                    method: 'POST',
                    json: { id: 'baz' }
                  }).should.eventually.be.rejectedWith("400"));

                case 4:
                  context$3$0.next = 6;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/frame',
                    method: 'POST',
                    json: { id: 'baz' }
                  }));

                case 6:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should return the correct error even if driver does not throw', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/appium/receive_async_response',
                    method: 'POST',
                    json: { response: 'baz' },
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(500);
                  res.body.should.eql({
                    status: 13,
                    value: {
                      message: 'An unknown server-side error occurred while processing ' + 'the command. Original error: Mishandled Driver Error'
                    },
                    sessionId: "foo"
                  });

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          describe('w3c sendkeys migration', function () {
            it('should accept value for sendkeys', function callee$3$0() {
              var res;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                      url: 'http://localhost:8181/wd/hub/session/foo/element/bar/value',
                      method: 'POST',
                      json: { value: "text to type" }
                    }));

                  case 2:
                    res = context$4$0.sent;

                    res.status.should.equal(0);
                    res.value.should.eql(["text to type", "bar"]);

                  case 5:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this);
            });
            it('should accept text for sendkeys', function callee$3$0() {
              var res;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                      url: 'http://localhost:8181/wd/hub/session/foo/element/bar/value',
                      method: 'POST',
                      json: { text: "text to type" }
                    }));

                  case 2:
                    res = context$4$0.sent;

                    res.status.should.equal(0);
                    res.value.should.eql(["text to type", "bar"]);

                  case 5:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this);
            });
            it('should accept value and text for sendkeys, and use value', function callee$3$0() {
              var res;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                      url: 'http://localhost:8181/wd/hub/session/foo/element/bar/value',
                      method: 'POST',
                      json: { value: "text to type", text: "text to ignore" }
                    }));

                  case 2:
                    res = context$4$0.sent;

                    res.status.should.equal(0);
                    res.value.should.eql(["text to type", "bar"]);

                  case 5:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this);
            });
          });

          describe('multiple sets of arguments', function () {
            describe('optional', function () {
              it('should allow moveto with element', function callee$4$0() {
                var res;
                return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                  while (1) switch (context$5$0.prev = context$5$0.next) {
                    case 0:
                      context$5$0.next = 2;
                      return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                        url: 'http://localhost:8181/wd/hub/session/foo/moveto',
                        method: 'POST',
                        json: { element: '3' }
                      }));

                    case 2:
                      res = context$5$0.sent;

                      res.status.should.equal(0);
                      res.value.should.eql(['3', null, null]);

                    case 5:
                    case 'end':
                      return context$5$0.stop();
                  }
                }, null, _this);
              });
              it('should allow moveto with xoffset/yoffset', function callee$4$0() {
                var res;
                return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                  while (1) switch (context$5$0.prev = context$5$0.next) {
                    case 0:
                      context$5$0.next = 2;
                      return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                        url: 'http://localhost:8181/wd/hub/session/foo/moveto',
                        method: 'POST',
                        json: { xoffset: 42, yoffset: 17 }
                      }));

                    case 2:
                      res = context$5$0.sent;

                      res.status.should.equal(0);
                      res.value.should.eql([null, 42, 17]);

                    case 5:
                    case 'end':
                      return context$5$0.stop();
                  }
                }, null, _this);
              });
            });
            describe('required', function () {
              it('should allow removeApp with appId', function callee$4$0() {
                var res;
                return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                  while (1) switch (context$5$0.prev = context$5$0.next) {
                    case 0:
                      context$5$0.next = 2;
                      return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                        url: 'http://localhost:8181/wd/hub/session/foo/appium/device/remove_app',
                        method: 'POST',
                        json: { appId: 42 }
                      }));

                    case 2:
                      res = context$5$0.sent;

                      res.status.should.equal(0);
                      res.value.should.eql(42);

                    case 5:
                    case 'end':
                      return context$5$0.stop();
                  }
                }, null, _this);
              });
              it('should allow removeApp with bundleId', function callee$4$0() {
                var res;
                return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                  while (1) switch (context$5$0.prev = context$5$0.next) {
                    case 0:
                      context$5$0.next = 2;
                      return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                        url: 'http://localhost:8181/wd/hub/session/foo/appium/device/remove_app',
                        method: 'POST',
                        json: { bundleId: 42 }
                      }));

                    case 2:
                      res = context$5$0.sent;

                      res.status.should.equal(0);
                      res.value.should.eql(42);

                    case 5:
                    case 'end':
                      return context$5$0.stop();
                  }
                }, null, _this);
              });
            });
          });

          describe('default param wrap', function () {

            it('should wrap', function callee$3$0() {
              var res;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                      url: 'http://localhost:8181/wd/hub/session/foo/touch/perform',
                      method: 'POST',
                      json: [{ "action": "tap", "options": { "element": "3" } }]
                    }));

                  case 2:
                    res = context$4$0.sent;

                    res.value.should.deep.equal([[{ "action": "tap", "options": { "element": "3" } }], 'foo']);

                  case 4:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this);
            });

            it('should not wrap twice', function callee$3$0() {
              var res;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                      url: 'http://localhost:8181/wd/hub/session/foo/touch/perform',
                      method: 'POST',
                      json: { actions: [{ "action": "tap", "options": { "element": "3" } }] }
                    }));

                  case 2:
                    res = context$4$0.sent;

                    res.value.should.deep.equal([[{ "action": "tap", "options": { "element": "3" } }], 'foo']);

                  case 4:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this);
            });
          });

          describe('create sessions via HTTP endpoint', function () {
            var desiredCapabilities = { a: 'b' };
            var requiredCapabilities = { c: 'd' };
            var capabilities = { e: 'f' };
            var baseUrl = 'http://localhost:8181/wd/hub/session';

            it('should allow create session with desired caps (MJSONWP)', function callee$3$0() {
              var res;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                      url: baseUrl,
                      method: 'POST',
                      json: { desiredCapabilities: desiredCapabilities }
                    }));

                  case 2:
                    res = context$4$0.sent;

                    res.status.should.equal(0);
                    res.value.should.eql(desiredCapabilities);

                  case 5:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this);
            });
            it('should allow create session with desired and required caps', function callee$3$0() {
              var res;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                      url: baseUrl,
                      method: 'POST',
                      json: {
                        desiredCapabilities: desiredCapabilities,
                        requiredCapabilities: requiredCapabilities
                      }
                    }));

                  case 2:
                    res = context$4$0.sent;

                    res.status.should.equal(0);
                    res.value.should.eql(_lodash2['default'].extend({}, desiredCapabilities, requiredCapabilities));

                  case 5:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this);
            });
            it('should fail to create session without capabilities or desiredCapabilities', function callee$3$0() {
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                      url: baseUrl,
                      method: 'POST',
                      json: {}
                    }).should.eventually.be.rejectedWith('400'));

                  case 2:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this);
            });
            it('should allow create session with capabilities (W3C)', function callee$3$0() {
              var _ref, status, value, sessionId;

              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                      url: baseUrl,
                      method: 'POST',
                      json: {
                        capabilities: capabilities
                      }
                    }));

                  case 2:
                    _ref = context$4$0.sent;
                    status = _ref.status;
                    value = _ref.value;
                    sessionId = _ref.sessionId;

                    should.not.exist(status);
                    should.not.exist(sessionId);
                    value.capabilities.should.eql(capabilities);
                    value.sessionId.should.exist;

                  case 10:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this);
            });

            describe('w3c endpoints', function callee$3$0() {
              var w3cCaps, sessionUrl, sessionId;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                var _this2 = this;

                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    w3cCaps = {
                      alwaysMatch: {
                        platformName: 'Fake',
                        deviceName: 'Commodore 64'
                      },
                      firstMatch: [{}]
                    };
                    sessionUrl = undefined;
                    sessionId = undefined;

                    beforeEach(function callee$4$0() {
                      var _ref2,
                      // Start a session
                      value;

                      return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                        while (1) switch (context$5$0.prev = context$5$0.next) {
                          case 0:
                            context$5$0.next = 2;
                            return _regeneratorRuntime.awrap(_requestPromise2['default'].post(baseUrl, {
                              json: {
                                capabilities: w3cCaps
                              }
                            }));

                          case 2:
                            _ref2 = context$5$0.sent;
                            value = _ref2.value;

                            sessionId = value.sessionId;
                            sessionUrl = baseUrl + '/' + sessionId;

                          case 6:
                          case 'end':
                            return context$5$0.stop();
                        }
                      }, null, this);
                    });

                    afterEach(function callee$4$0() {
                      return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                        while (1) switch (context$5$0.prev = context$5$0.next) {
                          case 0:
                            context$5$0.next = 2;
                            return _regeneratorRuntime.awrap(_requestPromise2['default']['delete'](sessionUrl));

                          case 2:
                          case 'end':
                            return context$5$0.stop();
                        }
                      }, null, this);
                    });

                    it('should throw 400 Bad Parameters exception if the parameters are bad', function callee$4$0() {
                      var _ref3, message, statusCode;

                      return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                        while (1) switch (context$5$0.prev = context$5$0.next) {
                          case 0:
                            context$5$0.next = 2;
                            return _regeneratorRuntime.awrap(_requestPromise2['default'].post(sessionUrl + '/actions', {
                              json: {
                                bad: 'params'
                              }
                            }).should.eventually.be.rejected);

                          case 2:
                            _ref3 = context$5$0.sent;
                            message = _ref3.message;
                            statusCode = _ref3.statusCode;

                            message.should.match(/Parameters were incorrect/);
                            statusCode.should.equal(400);

                          case 7:
                          case 'end':
                            return context$5$0.stop();
                        }
                      }, null, _this2);
                    });

                    it('should throw 404 Not Found exception if the command hasn\'t been implemented yet', function callee$4$0() {
                      var _ref4, message, statusCode;

                      return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                        while (1) switch (context$5$0.prev = context$5$0.next) {
                          case 0:
                            context$5$0.next = 2;
                            return _regeneratorRuntime.awrap(_requestPromise2['default'].post(sessionUrl + '/actions', {
                              json: {
                                actions: []
                              }
                            }).should.eventually.be.rejected);

                          case 2:
                            _ref4 = context$5$0.sent;
                            message = _ref4.message;
                            statusCode = _ref4.statusCode;

                            message.should.match(/Method has not yet been implemented/);
                            statusCode.should.equal(404);

                          case 7:
                          case 'end':
                            return context$5$0.stop();
                        }
                      }, null, _this2);
                    });

                    it('should throw 500 Unknown Error if the command throws an unexpected exception', function callee$4$0() {
                      var _ref5, message, statusCode;

                      return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                        while (1) switch (context$5$0.prev = context$5$0.next) {
                          case 0:
                            driver.performActions = function () {
                              throw new Error('Didn\'t work');
                            };
                            context$5$0.next = 3;
                            return _regeneratorRuntime.awrap(_requestPromise2['default'].post(sessionUrl + '/actions', {
                              json: {
                                actions: []
                              }
                            }).should.eventually.be.rejected);

                          case 3:
                            _ref5 = context$5$0.sent;
                            message = _ref5.message;
                            statusCode = _ref5.statusCode;

                            message.should.match(/500[\w\W]*Didn't work/);
                            statusCode.should.equal(500);
                            delete driver.performActions;

                          case 9:
                          case 'end':
                            return context$5$0.stop();
                        }
                      }, null, _this2);
                    });

                    it('should fail with a 408 error if it throws a TimeoutError exception', function callee$4$0() {
                      var _ref6, statusCode;

                      return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                        while (1) switch (context$5$0.prev = context$5$0.next) {
                          case 0:
                            _sinon2['default'].stub(driver, 'setUrl', function () {
                              throw new _2.errors.TimeoutError();
                            });
                            context$5$0.next = 3;
                            return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                              url: sessionUrl + '/url',
                              method: 'POST',
                              json: {
                                url: 'https://example.com/'
                              }
                            }).should.eventually.be.rejected);

                          case 3:
                            _ref6 = context$5$0.sent;
                            statusCode = _ref6.statusCode;

                            statusCode.should.equal(408);
                            _sinon2['default'].restore(driver, 'setUrl');

                          case 7:
                          case 'end':
                            return context$5$0.stop();
                        }
                      }, null, _this2);
                    });

                    it('should pass with 200 HTTP status code if the command returns a value', function callee$4$0() {
                      var _ref7, status, value, sessionId;

                      return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                        while (1) switch (context$5$0.prev = context$5$0.next) {
                          case 0:
                            driver.performActions = function (actions) {
                              return 'It works ' + actions.join('');
                            };
                            context$5$0.next = 3;
                            return _regeneratorRuntime.awrap(_requestPromise2['default'].post(sessionUrl + '/actions', {
                              json: {
                                actions: ['a', 'b', 'c']
                              }
                            }));

                          case 3:
                            _ref7 = context$5$0.sent;
                            status = _ref7.status;
                            value = _ref7.value;
                            sessionId = _ref7.sessionId;

                            should.not.exist(sessionId);
                            should.not.exist(status);
                            value.should.equal('It works abc');
                            delete driver.performActions;

                          case 11:
                          case 'end':
                            return context$5$0.stop();
                        }
                      }, null, _this2);
                    });

                    describe('jwproxy', function () {
                      var _this4 = this;

                      var port = 56562;
                      var server = undefined,
                          jwproxy = undefined,
                          app = undefined;
                      beforeEach(function () {
                        var _this3 = this;

                        var res = (0, _helpers.createProxyServer)(sessionId, port);
                        server = res.server;
                        app = res.app;
                        jwproxy = new _2.JWProxy({ host: 'localhost', port: port });
                        jwproxy.sessionId = sessionId;
                        driver.performActions = function callee$6$0(actions) {
                          return _regeneratorRuntime.async(function callee$6$0$(context$7$0) {
                            while (1) switch (context$7$0.prev = context$7$0.next) {
                              case 0:
                                context$7$0.next = 2;
                                return _regeneratorRuntime.awrap(jwproxy.command('/perform-actions', 'POST', actions));

                              case 2:
                                return context$7$0.abrupt('return', context$7$0.sent);

                              case 3:
                              case 'end':
                                return context$7$0.stop();
                            }
                          }, null, _this3);
                        };
                      });

                      afterEach(function () {
                        server.close();
                        delete driver.performActions;
                      });

                      it('should work if a proxied request returns a response with status 200', function callee$5$0() {
                        var _ref8, status, value, sessionId;

                        return _regeneratorRuntime.async(function callee$5$0$(context$6$0) {
                          while (1) switch (context$6$0.prev = context$6$0.next) {
                            case 0:
                              (0, _helpers.addHandler)(app, 'post', '/wd/hub/session/:sessionId/perform-actions', function (req, res) {
                                res.json({
                                  sessionId: req.params.sessionId,
                                  value: req.body,
                                  status: 0
                                });
                              });

                              context$6$0.next = 3;
                              return _regeneratorRuntime.awrap(_requestPromise2['default'].post(sessionUrl + '/actions', {
                                json: {
                                  actions: [1, 2, 3]
                                }
                              }));

                            case 3:
                              _ref8 = context$6$0.sent;
                              status = _ref8.status;
                              value = _ref8.value;
                              sessionId = _ref8.sessionId;

                              value.should.eql([1, 2, 3]);
                              should.not.exist(status);
                              should.not.exist(sessionId);

                            case 10:
                            case 'end':
                              return context$6$0.stop();
                          }
                        }, null, _this4);
                      });

                      it('should work if a proxied request returns a MJSONWP error response', function callee$5$0() {
                        var _ref9, statusCode, message;

                        return _regeneratorRuntime.async(function callee$5$0$(context$6$0) {
                          while (1) switch (context$6$0.prev = context$6$0.next) {
                            case 0:
                              (0, _helpers.addHandler)(app, 'post', '/wd/hub/session/:sessionId/perform-actions', function (req, res) {
                                res.status(500).json({
                                  sessionId: sessionId,
                                  status: 6,
                                  value: 'A problem occurred'
                                });
                              });
                              context$6$0.next = 3;
                              return _regeneratorRuntime.awrap(_requestPromise2['default'].post(sessionUrl + '/actions', {
                                json: {
                                  actions: [1, 2, 3]
                                }
                              }).should.eventually.be.rejected);

                            case 3:
                              _ref9 = context$6$0.sent;
                              statusCode = _ref9.statusCode;
                              message = _ref9.message;

                              statusCode.should.equal(_httpStatusCodes2['default'].NOT_FOUND);
                              message.should.match(/A problem occurred/);

                            case 8:
                            case 'end':
                              return context$6$0.stop();
                          }
                        }, null, _this4);
                      });
                    });

                  case 11:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, this);
            });
          });

          it('should handle commands with no response values', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/forward',
                    method: 'POST',
                    json: true
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.should.eql({
                    status: 0,
                    value: null,
                    sessionId: "foo"
                  });

                case 4:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should allow empty string response values', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/element/bar/text',
                    method: 'GET',
                    json: true
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.should.eql({
                    status: 0,
                    value: "",
                    sessionId: "foo"
                  });

                case 4:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should send 500 response and an Unknown object for rejected commands', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo/refresh',
                    method: 'POST',
                    json: true,
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(500);
                  res.body.should.eql({
                    status: 13,
                    value: {
                      message: 'An unknown server-side error occurred while processing ' + 'the command. Original error: Too Fresh!'
                    },
                    sessionId: "foo"
                  });

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should not throw UnknownError when known', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/foo',
                    method: 'GET',
                    json: true,
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 2:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(404);
                  res.body.should.eql({
                    status: 6,
                    value: {
                      message: 'A session is either terminated or not started'
                    },
                    sessionId: "foo"
                  });

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });
        });

        describe('session Ids', function () {
          var driver = new _fakeDriver.FakeDriver();
          var mjsonwpServer = undefined;

          before(function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _2.server)((0, _2.routeConfiguringFunction)(driver), 8181));

                case 2:
                  mjsonwpServer = context$3$0.sent;

                case 3:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          after(function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  mjsonwpServer.close();

                case 1:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          afterEach(function () {
            driver.sessionId = null;
          });

          it('returns null SessionId for commands without sessionIds', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/status',
                    method: 'GET',
                    json: true
                  }));

                case 2:
                  res = context$3$0.sent;

                  should.equal(res.sessionId, null);

                case 4:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('responds with the same session ID in the request', function callee$2$0() {
            var sessionId, res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  sessionId = 'Vader Sessions';

                  driver.sessionId = sessionId;

                  context$3$0.next = 4;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/url',
                    method: 'POST',
                    json: { url: 'http://google.com' }
                  }));

                case 4:
                  res = context$3$0.sent;

                  should.exist(res.sessionId);
                  res.sessionId.should.eql(sessionId);

                case 7:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('yells if no session exists', function callee$2$0() {
            var sessionId, res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  sessionId = 'Vader Sessions';
                  context$3$0.next = 3;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/url',
                    method: 'POST',
                    json: { url: 'http://google.com' },
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 3:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(404);
                  res.body.status.should.equal(6);
                  res.body.value.message.should.contain('session');

                case 7:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('yells if invalid session is sent', function callee$2$0() {
            var sessionId, res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  sessionId = 'Vader Sessions';

                  driver.sessionId = 'recession';

                  context$3$0.next = 4;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/url',
                    method: 'POST',
                    json: { url: 'http://google.com' },
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 4:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(404);
                  res.body.status.should.equal(6);
                  res.body.value.message.should.contain('session');

                case 8:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should have session IDs in error responses', function callee$2$0() {
            var sessionId, res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  sessionId = 'Vader Sessions';

                  driver.sessionId = sessionId;

                  context$3$0.next = 4;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/refresh',
                    method: 'POST',
                    json: true,
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 4:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(500);
                  res.body.should.eql({
                    status: 13,
                    value: {
                      message: 'An unknown server-side error occurred while processing ' + 'the command. Original error: Too Fresh!'
                    },
                    sessionId: sessionId
                  });

                case 7:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should return a new session ID on create', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session',
                    method: 'POST',
                    json: { desiredCapabilities: { greeting: 'hello' }, requiredCapabilities: { valediction: 'bye' } }
                  }));

                case 2:
                  res = context$3$0.sent;

                  should.exist(res.sessionId);
                  res.sessionId.should.equal('1234');
                  res.value.should.eql({ greeting: 'hello', valediction: 'bye' });

                case 6:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });
        });

        describe('via drivers jsonwp proxy', function () {
          var driver = undefined;
          var sessionId = 'foo';
          var mjsonwpServer = undefined;

          beforeEach(function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  driver = new _fakeDriver.FakeDriver();
                  driver.sessionId = sessionId;
                  driver.proxyActive = function () {
                    return true;
                  };
                  driver.canProxy = function () {
                    return true;
                  };

                  context$3$0.next = 6;
                  return _regeneratorRuntime.awrap((0, _2.server)((0, _2.routeConfiguringFunction)(driver), 8181));

                case 6:
                  mjsonwpServer = context$3$0.sent;

                case 7:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          afterEach(function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  mjsonwpServer.close();

                case 1:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should give a nice error if proxying is set but no proxy function exists', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  driver.canProxy = function () {
                    return false;
                  };
                  context$3$0.next = 3;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/url',
                    method: 'POST',
                    json: { url: 'http://google.com' },
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 3:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(500);
                  res.body.should.eql({
                    status: 13,
                    value: {
                      message: 'An unknown server-side error occurred while processing ' + 'the command. Original error: Trying to proxy to a JSONWP ' + 'server but driver is unable to proxy'
                    },
                    sessionId: sessionId
                  });

                case 6:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should pass on any errors in proxying', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  driver.proxyReqRes = function callee$3$0() {
                    return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                      while (1) switch (context$4$0.prev = context$4$0.next) {
                        case 0:
                          throw new Error("foo");

                        case 1:
                        case 'end':
                          return context$4$0.stop();
                      }
                    }, null, this);
                  };
                  context$3$0.next = 3;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/url',
                    method: 'POST',
                    json: { url: 'http://google.com' },
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 3:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(500);
                  res.body.should.eql({
                    status: 13,
                    value: {
                      message: 'An unknown server-side error occurred while processing ' + 'the command. Original error: Could not proxy. Proxy ' + 'error: foo'
                    },
                    sessionId: sessionId
                  });

                case 6:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should able to throw ProxyRequestError in proxying', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  driver.proxyReqRes = function callee$3$0() {
                    var jsonwp;
                    return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                      while (1) switch (context$4$0.prev = context$4$0.next) {
                        case 0:
                          jsonwp = { status: 35, value: "No such context found.", sessionId: "foo" };
                          throw new _2.errors.ProxyRequestError('Could not proxy command to remote server. ', jsonwp);

                        case 2:
                        case 'end':
                          return context$4$0.stop();
                      }
                    }, null, this);
                  };
                  context$3$0.next = 3;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/url',
                    method: 'POST',
                    json: { url: 'http://google.com' },
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 3:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(500);
                  res.body.should.eql({
                    status: 35,
                    "value": { "message": "No such context found." },
                    sessionId: "foo"
                  });

                case 6:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should let the proxy handle req/res', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  driver.proxyReqRes = function callee$3$0(req, res) {
                    return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                      while (1) switch (context$4$0.prev = context$4$0.next) {
                        case 0:
                          res.status(200).json({ custom: 'data' });

                        case 1:
                        case 'end':
                          return context$4$0.stop();
                      }
                    }, null, this);
                  };
                  context$3$0.next = 3;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/url',
                    method: 'POST',
                    json: { url: 'http://google.com' },
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 3:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(200);
                  res.body.should.eql({ custom: 'data' });

                case 6:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should avoid jsonwp proxying when path matches avoidance list', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  driver.getProxyAvoidList = function () {
                    return [['POST', new RegExp('^/session/[^/]+/url$')]];
                  };
                  context$3$0.next = 3;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/url',
                    method: 'POST',
                    json: { url: 'http://google.com' },
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 3:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(200);
                  res.body.should.eql({
                    status: 0,
                    value: "Navigated to: http://google.com",
                    sessionId: sessionId
                  });

                case 6:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should fail if avoid proxy list is malformed in some way', function callee$2$0() {
            var badProxyAvoidanceList, lists, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, list;

            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  badProxyAvoidanceList = function badProxyAvoidanceList(list) {
                    var res;
                    return _regeneratorRuntime.async(function badProxyAvoidanceList$(context$4$0) {
                      while (1) switch (context$4$0.prev = context$4$0.next) {
                        case 0:
                          driver.getProxyAvoidList = function () {
                            return list;
                          };
                          context$4$0.next = 3;
                          return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                            url: 'http://localhost:8181/wd/hub/session/' + sessionId + '/url',
                            method: 'POST',
                            json: { url: 'http://google.com' },
                            resolveWithFullResponse: true,
                            simple: false
                          }));

                        case 3:
                          res = context$4$0.sent;

                          res.statusCode.should.equal(500);
                          res.body.status.should.equal(13);
                          res.body.value.message.should.contain("roxy");

                        case 7:
                        case 'end':
                          return context$4$0.stop();
                      }
                    }, null, this);
                  };

                  lists = ['foo', [['foo']], [['BAR', /lol/]], [['GET', 'foo']]];
                  _iteratorNormalCompletion = true;
                  _didIteratorError = false;
                  _iteratorError = undefined;
                  context$3$0.prev = 5;
                  _iterator = _getIterator(lists);

                case 7:
                  if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {
                    context$3$0.next = 14;
                    break;
                  }

                  list = _step.value;
                  context$3$0.next = 11;
                  return _regeneratorRuntime.awrap(badProxyAvoidanceList(list));

                case 11:
                  _iteratorNormalCompletion = true;
                  context$3$0.next = 7;
                  break;

                case 14:
                  context$3$0.next = 20;
                  break;

                case 16:
                  context$3$0.prev = 16;
                  context$3$0.t0 = context$3$0['catch'](5);
                  _didIteratorError = true;
                  _iteratorError = context$3$0.t0;

                case 20:
                  context$3$0.prev = 20;
                  context$3$0.prev = 21;

                  if (!_iteratorNormalCompletion && _iterator['return']) {
                    _iterator['return']();
                  }

                case 23:
                  context$3$0.prev = 23;

                  if (!_didIteratorError) {
                    context$3$0.next = 26;
                    break;
                  }

                  throw _iteratorError;

                case 26:
                  return context$3$0.finish(23);

                case 27:
                  return context$3$0.finish(20);

                case 28:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this, [[5, 16, 20, 28], [21,, 23, 27]]);
          });

          it('should avoid proxying non-session commands even if not in the list', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  driver.getProxyAvoidList = function () {
                    return [['POST', new RegExp('')]];
                  };

                  context$3$0.next = 3;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/status',
                    method: 'GET',
                    json: true,
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 3:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(200);
                  res.body.should.eql({
                    status: 0,
                    value: "I'm fine",
                    sessionId: null
                  });

                case 6:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });

          it('should avoid proxying deleteSession commands', function callee$2$0() {
            var res;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  driver.getProxyAvoidList = function () {
                    return [['POST', new RegExp('')]];
                  };

                  driver.sessionId.should.equal(sessionId);
                  context$3$0.next = 4;
                  return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                    url: 'http://localhost:8181/wd/hub/session/' + sessionId,
                    method: 'DELETE',
                    json: true,
                    resolveWithFullResponse: true,
                    simple: false
                  }));

                case 4:
                  res = context$3$0.sent;

                  res.statusCode.should.equal(200);
                  should.not.exist(driver.sessionId);
                  driver.jwpProxyActive.should.be['false'];

                case 8:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, _this);
          });
        });

      case 4:
      case 'end':
        return context$1$0.stop();
    }
  }, null, _this5);
});

// make sure adding the optional 'id' doesn't clobber a route where we
// have an actual required 'id'

// Delete the session
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvbWpzb253cC9tanNvbndwLWUyZS1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7aUJBRWtFLE9BQU87OzBCQUM5QyxlQUFlOztzQkFDNUIsUUFBUTs7Ozs4QkFDRixpQkFBaUI7Ozs7b0JBQ3BCLE1BQU07Ozs7OEJBQ0ksa0JBQWtCOzs7O3FCQUMzQixPQUFPOzs7OytCQUNHLG1CQUFtQjs7Ozt1QkFDRCxXQUFXOztBQUV6RCxJQUFJLE1BQU0sR0FBRyxrQkFBSyxNQUFNLEVBQUUsQ0FBQztBQUMzQixrQkFBSyxHQUFHLDZCQUFnQixDQUFDOztBQUV6QixRQUFRLENBQUMsU0FBUyxFQUFFOzs7Ozs7Ozs7O0FBS2xCLGdCQUFRLENBQUMsa0JBQWtCLEVBQUUsWUFBTTtBQUNqQyxjQUFJLENBQUMsR0FBRyw0QkFBZ0IsQ0FBQztBQUN6QixZQUFFLENBQUMsd0RBQXdELEVBQUU7Ozs7O21EQUNwRCxDQUFDLENBQUMsTUFBTSxDQUFDLG1CQUFtQixDQUFDOzs7bUNBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFROzs7Ozs7O1dBQzlELENBQUMsQ0FBQztTQUNKLENBQUMsQ0FBQzs7QUFFSCxnQkFBUSxDQUFDLG9CQUFvQixFQUFFLFlBQU07QUFDbkMsY0FBSSxhQUFhLFlBQUEsQ0FBQztBQUNsQixjQUFJLE1BQU0sWUFBQSxDQUFDOztBQUVYLGdCQUFNLENBQUM7Ozs7QUFDTCx3QkFBTSxHQUFHLDRCQUFnQixDQUFDO0FBQzFCLHdCQUFNLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQzs7bURBQ0gsZUFBTyxpQ0FBeUIsTUFBTSxDQUFDLEVBQUUsSUFBSSxDQUFDOzs7QUFBcEUsK0JBQWE7Ozs7Ozs7V0FDZCxDQUFDLENBQUM7O0FBRUgsZUFBSyxDQUFDOzs7O0FBQ0osK0JBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQzs7Ozs7OztXQUN2QixDQUFDLENBQUM7O0FBRUgsWUFBRSxDQUFDLHlEQUF5RCxFQUFFO2dCQUN4RCxH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QiwwQkFBTSxFQUFFLEtBQUs7bUJBQ2QsQ0FBQzs7O0FBTkUscUJBQUc7O0FBUVAscUJBQUcsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNqQyx3QkFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ25DLHdCQUFNLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxFQUFFLFNBQU0sQ0FBQzs7Ozs7OztXQUN2QyxDQUFDLENBQUM7U0FDSixDQUFDLENBQUM7Ozs7Ozs7Q0FDSixDQUFDLENBQUMiLCJmaWxlIjoidGVzdC9tanNvbndwL21qc29ud3AtZTJlLXNwZWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gdHJhbnNwaWxlOm1vY2hhXG5cbmltcG9ydCB7IHNlcnZlciwgcm91dGVDb25maWd1cmluZ0Z1bmN0aW9uLCBlcnJvcnMsIEpXUHJveHkgfSBmcm9tICcuLi8uLic7XG5pbXBvcnQgeyBGYWtlRHJpdmVyIH0gZnJvbSAnLi9mYWtlLWRyaXZlcic7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHJlcXVlc3QgZnJvbSAncmVxdWVzdC1wcm9taXNlJztcbmltcG9ydCBjaGFpIGZyb20gJ2NoYWknO1xuaW1wb3J0IGNoYWlBc1Byb21pc2VkIGZyb20gJ2NoYWktYXMtcHJvbWlzZWQnO1xuaW1wb3J0IHNpbm9uIGZyb20gJ3Npbm9uJztcbmltcG9ydCBIVFRQU3RhdHVzQ29kZXMgZnJvbSAnaHR0cC1zdGF0dXMtY29kZXMnO1xuaW1wb3J0IHsgY3JlYXRlUHJveHlTZXJ2ZXIsIGFkZEhhbmRsZXIgfSBmcm9tICcuL2hlbHBlcnMnO1xuXG5sZXQgc2hvdWxkID0gY2hhaS5zaG91bGQoKTtcbmNoYWkudXNlKGNoYWlBc1Byb21pc2VkKTtcblxuZGVzY3JpYmUoJ01KU09OV1AnLCBhc3luYyAoKSA9PiB7XG5cbiAgLy9UT0RPOiBtb3JlIHRlc3RzITpcbiAgLy8gVW5rbm93biBjb21tYW5kcyBzaG91bGQgcmV0dXJuIDQwNFxuXG4gIGRlc2NyaWJlKCdkaXJlY3QgdG8gZHJpdmVyJywgKCkgPT4ge1xuICAgIGxldCBkID0gbmV3IEZha2VEcml2ZXIoKTtcbiAgICBpdCgnc2hvdWxkIHJldHVybiByZXNwb25zZSB2YWx1ZXMgZGlyZWN0bHkgZnJvbSB0aGUgZHJpdmVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGF3YWl0IGQuc2V0VXJsKFwiaHR0cDovL2dvb2dsZS5jb21cIikpLnNob3VsZC5jb250YWluKFwiZ29vZ2xlXCIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndmlhIGV4cHJlc3Mgcm91dGVyJywgKCkgPT4ge1xuICAgIGxldCBtanNvbndwU2VydmVyO1xuICAgIGxldCBkcml2ZXI7XG5cbiAgICBiZWZvcmUoYXN5bmMgKCkgPT4ge1xuICAgICAgZHJpdmVyID0gbmV3IEZha2VEcml2ZXIoKTtcbiAgICAgIGRyaXZlci5zZXNzaW9uSWQgPSAnZm9vJztcbiAgICAgIG1qc29ud3BTZXJ2ZXIgPSBhd2FpdCBzZXJ2ZXIocm91dGVDb25maWd1cmluZ0Z1bmN0aW9uKGRyaXZlciksIDgxODEpO1xuICAgIH0pO1xuXG4gICAgYWZ0ZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgbWpzb253cFNlcnZlci5jbG9zZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm94eSB0byBkcml2ZXIgYW5kIHJldHVybiB2YWxpZCBqc29ud3AgcmVzcG9uc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi9mb28vdXJsJyxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IHt1cmw6ICdodHRwOi8vZ29vZ2xlLmNvbSd9XG4gICAgICB9KTtcbiAgICAgIHJlcy5zaG91bGQuZXFsKHtcbiAgICAgICAgc3RhdHVzOiAwLFxuICAgICAgICB2YWx1ZTogXCJOYXZpZ2F0ZWQgdG86IGh0dHA6Ly9nb29nbGUuY29tXCIsXG4gICAgICAgIHNlc3Npb25JZDogXCJmb29cIlxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFzc3VtZSByZXF1ZXN0cyB3aXRob3V0IGEgQ29udGVudC1UeXBlIGFyZSBqc29uIHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL3VybCcsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7dXJsOiAnaHR0cDovL2dvb2dsZS5jb20nfSksXG4gICAgICB9KTtcbiAgICAgIEpTT04ucGFyc2UocmVzKS5zaG91bGQuZXFsKHtcbiAgICAgICAgc3RhdHVzOiAwLFxuICAgICAgICB2YWx1ZTogXCJOYXZpZ2F0ZWQgdG86IGh0dHA6Ly9nb29nbGUuY29tXCIsXG4gICAgICAgIHNlc3Npb25JZDogXCJmb29cIlxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlc3BvbmQgdG8geC13d3ctZm9ybS11cmxlbmNvZGVkIGFzIHdlbGwgYXMganNvbiByZXF1ZXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby91cmwnLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgZm9ybToge3VybDogJ2h0dHA6Ly9nb29nbGUuY29tJ31cbiAgICAgIH0pO1xuICAgICAgSlNPTi5wYXJzZShyZXMpLnNob3VsZC5lcWwoe1xuICAgICAgICBzdGF0dXM6IDAsXG4gICAgICAgIHZhbHVlOiBcIk5hdmlnYXRlZCB0bzogaHR0cDovL2dvb2dsZS5jb21cIixcbiAgICAgICAgc2Vzc2lvbklkOiBcImZvb1wiXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSB1cmwgcmVxdWVzdCBwYXJhbWV0ZXJzIGZvciBtZXRob2RzIHRvIHVzZSAtIHNlc3Npb25pZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby9iYWNrJyxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IHt9LFxuICAgICAgICBzaW1wbGU6IGZhbHNlLFxuICAgICAgICByZXNvbHZlV2l0aEZ1bGxSZXNwb25zZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICByZXMuYm9keS5zaG91bGQuZXFsKHtcbiAgICAgICAgc3RhdHVzOiAwLFxuICAgICAgICB2YWx1ZTogXCJmb29cIixcbiAgICAgICAgc2Vzc2lvbklkOiBcImZvb1wiXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSB1cmwgcmVxdWVzdCBwYXJhbWV0ZXJzIGZvciBtZXRob2RzIHRvIHVzZSAtIGVsZW1lbnRpZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby9lbGVtZW50L2Jhci9jbGljaycsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBqc29uOiB7fVxuICAgICAgfSk7XG4gICAgICByZXMuc3RhdHVzLnNob3VsZC5lcXVhbCgwKTtcbiAgICAgIHJlcy52YWx1ZS5zaG91bGQuZXFsKFtcImJhclwiLCBcImZvb1wiXSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgdXJsIHJlcSBwYXJhbXMgaW4gdGhlIG9yZGVyOiBjdXN0b20sIGVsZW1lbnQsIHNlc3Npb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi9mb28vZWxlbWVudC9iYXIvYXR0cmlidXRlL2JheicsXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGpzb246IHt9XG4gICAgICB9KTtcbiAgICAgIHJlcy5zdGF0dXMuc2hvdWxkLmVxdWFsKDApO1xuICAgICAgcmVzLnZhbHVlLnNob3VsZC5lcWwoW1wiYmF6XCIsIFwiYmFyXCIsIFwiZm9vXCJdKTtcblxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXNwb25kIHdpdGggNDAwIEJhZCBSZXF1ZXN0IGlmIHBhcmFtZXRlcnMgbWlzc2luZycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby91cmwnLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAganNvbjoge30sXG4gICAgICAgIHJlc29sdmVXaXRoRnVsbFJlc3BvbnNlOiB0cnVlLFxuICAgICAgICBzaW1wbGU6IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgcmVzLnN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDQwMCk7XG4gICAgICByZXMuYm9keS5zaG91bGQuY29udGFpbihcInVybFwiKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IHJlcXVlc3RzIHdpdGggYSBiYWRseSBmb3JtYXR0ZWQgYm9keSBhbmQgbm90IGNyYXNoJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi9mb28vdXJsJyxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IFwib2ggaGVsbG9cIlxuICAgICAgfSkuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWQ7XG5cbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby91cmwnLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAganNvbjoge3VybDogJ2h0dHA6Ly9nb29nbGUuY29tJ31cbiAgICAgIH0pO1xuICAgICAgcmVzLnNob3VsZC5lcWwoe1xuICAgICAgICBzdGF0dXM6IDAsXG4gICAgICAgIHZhbHVlOiBcIk5hdmlnYXRlZCB0bzogaHR0cDovL2dvb2dsZS5jb21cIixcbiAgICAgICAgc2Vzc2lvbklkOiBcImZvb1wiXG4gICAgICB9KTtcblxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgNDA0IGZvciBiYWQgcm91dGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvYmxhcmdpbWFyZycsXG4gICAgICAgIG1ldGhvZDogJ0dFVCdcbiAgICAgIH0pLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aChcIjQwNFwiKTtcbiAgICB9KTtcblxuICAgIC8vIFRPRE8gcGFzcyB0aGlzIHRlc3RcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL25vZGUtbW9iaWxlLWpzb24td2lyZS1wcm90b2NvbC9pc3N1ZXMvM1xuICAgIGl0KCc0eHggcmVzcG9uc2VzIHNob3VsZCBoYXZlIGNvbnRlbnQtdHlwZSBvZiB0ZXh0L3BsYWluJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL2JsYXJnaW1hcmdhcml0YScsXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIHJlc29sdmVXaXRoRnVsbFJlc3BvbnNlOiB0cnVlLFxuICAgICAgICBzaW1wbGU6IGZhbHNlIC8vIDQwNCBlcnJvcnMgZnVsZmlsbCB0aGUgcHJvbWlzZSwgcmF0aGVyIHRoYW4gcmVqZWN0aW5nXG4gICAgICB9KTtcblxuICAgICAgcmVzLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddLnNob3VsZC5pbmNsdWRlKCd0ZXh0L3BsYWluJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IG5vdCB5ZXQgaW1wbGVtZW50ZWQgZm9yIHVuZmlsbGVkb3V0IGNvbW1hbmRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL2VsZW1lbnQvYmFyL2xvY2F0aW9uJyxcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAganNvbjogdHJ1ZSxcbiAgICAgICAgcmVzb2x2ZVdpdGhGdWxsUmVzcG9uc2U6IHRydWUsXG4gICAgICAgIHNpbXBsZTogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICByZXMuc3RhdHVzQ29kZS5zaG91bGQuZXF1YWwoNTAxKTtcbiAgICAgIHJlcy5ib2R5LnNob3VsZC5lcWwoe1xuICAgICAgICBzdGF0dXM6IDEzLFxuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIG1lc3NhZ2U6ICdNZXRob2QgaGFzIG5vdCB5ZXQgYmVlbiBpbXBsZW1lbnRlZCdcbiAgICAgICAgfSxcbiAgICAgICAgc2Vzc2lvbklkOiAnZm9vJ1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IG5vdCBpbXBsZW1lbnRlZCBmb3IgaWdub3JlZCBjb21tYW5kcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby9idXR0b251cCcsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBqc29uOiB7fSxcbiAgICAgICAgcmVzb2x2ZVdpdGhGdWxsUmVzcG9uc2U6IHRydWUsXG4gICAgICAgIHNpbXBsZTogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICByZXMuc3RhdHVzQ29kZS5zaG91bGQuZXF1YWwoNTAxKTtcbiAgICAgIHJlcy5ib2R5LnNob3VsZC5lcWwoe1xuICAgICAgICBzdGF0dXM6IDEzLFxuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIG1lc3NhZ2U6ICdNZXRob2QgaXMgbm90IGltcGxlbWVudGVkJ1xuICAgICAgICB9LFxuICAgICAgICBzZXNzaW9uSWQ6ICdmb28nXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IDQwMCBmb3IgYmFkIHBhcmFtZXRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby91cmwnLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAganNvbjoge31cbiAgICAgIH0pLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aChcIjQwMFwiKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaWdub3JlIHNwZWNpYWwgZXh0cmEgcGF5bG9hZCBwYXJhbXMgaW4gdGhlIHJpZ2h0IGNvbnRleHRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi9mb28vZWxlbWVudC9iYXIvdmFsdWUnLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAganNvbjoge2lkOiAnYmF6Jywgc2Vzc2lvbklkOiAnbG9sJywgdmFsdWU6IFsnYSddfVxuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL2VsZW1lbnQvYmFyL3ZhbHVlJyxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IHtpZDogJ2Jheid9XG4gICAgICB9KS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoXCI0MDBcIik7XG5cbiAgICAgIC8vIG1ha2Ugc3VyZSBhZGRpbmcgdGhlIG9wdGlvbmFsICdpZCcgZG9lc24ndCBjbG9iYmVyIGEgcm91dGUgd2hlcmUgd2VcbiAgICAgIC8vIGhhdmUgYW4gYWN0dWFsIHJlcXVpcmVkICdpZCdcbiAgICAgIGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL2ZyYW1lJyxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IHtpZDogJ2Jheid9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRoZSBjb3JyZWN0IGVycm9yIGV2ZW4gaWYgZHJpdmVyIGRvZXMgbm90IHRocm93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHJlcyA9ICBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby9hcHBpdW0vcmVjZWl2ZV9hc3luY19yZXNwb25zZScsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBqc29uOiB7cmVzcG9uc2U6ICdiYXonfSxcbiAgICAgICAgcmVzb2x2ZVdpdGhGdWxsUmVzcG9uc2U6IHRydWUsXG4gICAgICAgIHNpbXBsZTogZmFsc2VcbiAgICAgIH0pO1xuICAgICAgcmVzLnN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDUwMCk7XG4gICAgICByZXMuYm9keS5zaG91bGQuZXFsKHtcbiAgICAgICAgc3RhdHVzOiAxMyxcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICBtZXNzYWdlOiAnQW4gdW5rbm93biBzZXJ2ZXItc2lkZSBlcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICd0aGUgY29tbWFuZC4gT3JpZ2luYWwgZXJyb3I6IE1pc2hhbmRsZWQgRHJpdmVyIEVycm9yJ1xuICAgICAgICB9LFxuICAgICAgICBzZXNzaW9uSWQ6IFwiZm9vXCJcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3czYyBzZW5ka2V5cyBtaWdyYXRpb24nLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGFjY2VwdCB2YWx1ZSBmb3Igc2VuZGtleXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL2VsZW1lbnQvYmFyL3ZhbHVlJyxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBqc29uOiB7dmFsdWU6IFwidGV4dCB0byB0eXBlXCJ9XG4gICAgICAgIH0pO1xuICAgICAgICByZXMuc3RhdHVzLnNob3VsZC5lcXVhbCgwKTtcbiAgICAgICAgcmVzLnZhbHVlLnNob3VsZC5lcWwoW1widGV4dCB0byB0eXBlXCIsIFwiYmFyXCJdKTtcbiAgICAgIH0pO1xuICAgICAgaXQoJ3Nob3VsZCBhY2NlcHQgdGV4dCBmb3Igc2VuZGtleXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL2VsZW1lbnQvYmFyL3ZhbHVlJyxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBqc29uOiB7dGV4dDogXCJ0ZXh0IHRvIHR5cGVcIn1cbiAgICAgICAgfSk7XG4gICAgICAgIHJlcy5zdGF0dXMuc2hvdWxkLmVxdWFsKDApO1xuICAgICAgICByZXMudmFsdWUuc2hvdWxkLmVxbChbXCJ0ZXh0IHRvIHR5cGVcIiwgXCJiYXJcIl0pO1xuICAgICAgfSk7XG4gICAgICBpdCgnc2hvdWxkIGFjY2VwdCB2YWx1ZSBhbmQgdGV4dCBmb3Igc2VuZGtleXMsIGFuZCB1c2UgdmFsdWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL2VsZW1lbnQvYmFyL3ZhbHVlJyxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBqc29uOiB7dmFsdWU6IFwidGV4dCB0byB0eXBlXCIsIHRleHQ6IFwidGV4dCB0byBpZ25vcmVcIn1cbiAgICAgICAgfSk7XG4gICAgICAgIHJlcy5zdGF0dXMuc2hvdWxkLmVxdWFsKDApO1xuICAgICAgICByZXMudmFsdWUuc2hvdWxkLmVxbChbXCJ0ZXh0IHRvIHR5cGVcIiwgXCJiYXJcIl0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnbXVsdGlwbGUgc2V0cyBvZiBhcmd1bWVudHMnLCAoKSA9PiB7XG4gICAgICBkZXNjcmliZSgnb3B0aW9uYWwnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgYWxsb3cgbW92ZXRvIHdpdGggZWxlbWVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL21vdmV0bycsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGpzb246IHtlbGVtZW50OiAnMyd9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmVzLnN0YXR1cy5zaG91bGQuZXF1YWwoMCk7XG4gICAgICAgICAgcmVzLnZhbHVlLnNob3VsZC5lcWwoWyczJywgbnVsbCwgbnVsbF0pO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCBhbGxvdyBtb3ZldG8gd2l0aCB4b2Zmc2V0L3lvZmZzZXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby9tb3ZldG8nLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBqc29uOiB7eG9mZnNldDogNDIsIHlvZmZzZXQ6IDE3fVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJlcy5zdGF0dXMuc2hvdWxkLmVxdWFsKDApO1xuICAgICAgICAgIHJlcy52YWx1ZS5zaG91bGQuZXFsKFtudWxsLCA0MiwgMTddKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIGRlc2NyaWJlKCdyZXF1aXJlZCcsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCBhbGxvdyByZW1vdmVBcHAgd2l0aCBhcHBJZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL2FwcGl1bS9kZXZpY2UvcmVtb3ZlX2FwcCcsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGpzb246IHthcHBJZDogNDJ9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmVzLnN0YXR1cy5zaG91bGQuZXF1YWwoMCk7XG4gICAgICAgICAgcmVzLnZhbHVlLnNob3VsZC5lcWwoNDIpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ3Nob3VsZCBhbGxvdyByZW1vdmVBcHAgd2l0aCBidW5kbGVJZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vZm9vL2FwcGl1bS9kZXZpY2UvcmVtb3ZlX2FwcCcsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGpzb246IHtidW5kbGVJZDogNDJ9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmVzLnN0YXR1cy5zaG91bGQuZXF1YWwoMCk7XG4gICAgICAgICAgcmVzLnZhbHVlLnNob3VsZC5lcWwoNDIpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2RlZmF1bHQgcGFyYW0gd3JhcCcsICgpID0+IHtcblxuICAgICAgaXQoJ3Nob3VsZCB3cmFwJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby90b3VjaC9wZXJmb3JtJyxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBqc29uOiBbe1wiYWN0aW9uXCI6XCJ0YXBcIiwgXCJvcHRpb25zXCI6e1wiZWxlbWVudFwiOlwiM1wifX1dXG4gICAgICAgIH0pO1xuICAgICAgICByZXMudmFsdWUuc2hvdWxkLmRlZXAuZXF1YWwoW1t7XCJhY3Rpb25cIjpcInRhcFwiLCBcIm9wdGlvbnNcIjp7XCJlbGVtZW50XCI6XCIzXCJ9fV0sICdmb28nXSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBub3Qgd3JhcCB0d2ljZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi9mb28vdG91Y2gvcGVyZm9ybScsXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAganNvbjoge2FjdGlvbnM6IFt7XCJhY3Rpb25cIjpcInRhcFwiLCBcIm9wdGlvbnNcIjp7XCJlbGVtZW50XCI6XCIzXCJ9fV19XG4gICAgICAgIH0pO1xuICAgICAgICByZXMudmFsdWUuc2hvdWxkLmRlZXAuZXF1YWwoW1t7XCJhY3Rpb25cIjpcInRhcFwiLCBcIm9wdGlvbnNcIjp7XCJlbGVtZW50XCI6XCIzXCJ9fV0sICdmb28nXSk7XG4gICAgICB9KTtcblxuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZSBzZXNzaW9ucyB2aWEgSFRUUCBlbmRwb2ludCcsICgpID0+IHtcbiAgICAgIGxldCBkZXNpcmVkQ2FwYWJpbGl0aWVzID0ge2E6ICdiJ307XG4gICAgICBsZXQgcmVxdWlyZWRDYXBhYmlsaXRpZXMgPSB7YzogJ2QnfTtcbiAgICAgIGxldCBjYXBhYmlsaXRpZXMgPSB7ZTogJ2YnfTtcbiAgICAgIGxldCBiYXNlVXJsID0gYGh0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbmA7XG5cbiAgICAgIGl0KCdzaG91bGQgYWxsb3cgY3JlYXRlIHNlc3Npb24gd2l0aCBkZXNpcmVkIGNhcHMgKE1KU09OV1ApJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgICAgdXJsOiBiYXNlVXJsLFxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGpzb246IHtkZXNpcmVkQ2FwYWJpbGl0aWVzfVxuICAgICAgICB9KTtcbiAgICAgICAgcmVzLnN0YXR1cy5zaG91bGQuZXF1YWwoMCk7XG4gICAgICAgIHJlcy52YWx1ZS5zaG91bGQuZXFsKGRlc2lyZWRDYXBhYmlsaXRpZXMpO1xuICAgICAgfSk7XG4gICAgICBpdCgnc2hvdWxkIGFsbG93IGNyZWF0ZSBzZXNzaW9uIHdpdGggZGVzaXJlZCBhbmQgcmVxdWlyZWQgY2FwcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIHVybDogYmFzZVVybCxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBqc29uOiB7XG4gICAgICAgICAgICBkZXNpcmVkQ2FwYWJpbGl0aWVzLFxuICAgICAgICAgICAgcmVxdWlyZWRDYXBhYmlsaXRpZXNcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXMuc3RhdHVzLnNob3VsZC5lcXVhbCgwKTtcbiAgICAgICAgcmVzLnZhbHVlLnNob3VsZC5lcWwoXy5leHRlbmQoe30sIGRlc2lyZWRDYXBhYmlsaXRpZXMsIHJlcXVpcmVkQ2FwYWJpbGl0aWVzKSk7XG4gICAgICB9KTtcbiAgICAgIGl0KCdzaG91bGQgZmFpbCB0byBjcmVhdGUgc2Vzc2lvbiB3aXRob3V0IGNhcGFiaWxpdGllcyBvciBkZXNpcmVkQ2FwYWJpbGl0aWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgICB1cmw6IGJhc2VVcmwsXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAganNvbjoge30sXG4gICAgICAgIH0pLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgnNDAwJyk7XG4gICAgICB9KTtcbiAgICAgIGl0KCdzaG91bGQgYWxsb3cgY3JlYXRlIHNlc3Npb24gd2l0aCBjYXBhYmlsaXRpZXMgKFczQyknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGxldCB7c3RhdHVzLCB2YWx1ZSwgc2Vzc2lvbklkfSA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIHVybDogYmFzZVVybCxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBqc29uOiB7XG4gICAgICAgICAgICBjYXBhYmlsaXRpZXMsXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgc2hvdWxkLm5vdC5leGlzdChzdGF0dXMpO1xuICAgICAgICBzaG91bGQubm90LmV4aXN0KHNlc3Npb25JZCk7XG4gICAgICAgIHZhbHVlLmNhcGFiaWxpdGllcy5zaG91bGQuZXFsKGNhcGFiaWxpdGllcyk7XG4gICAgICAgIHZhbHVlLnNlc3Npb25JZC5zaG91bGQuZXhpc3Q7XG4gICAgICB9KTtcblxuICAgICAgZGVzY3JpYmUoJ3czYyBlbmRwb2ludHMnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCB3M2NDYXBzID0ge1xuICAgICAgICAgIGFsd2F5c01hdGNoOiB7XG4gICAgICAgICAgICBwbGF0Zm9ybU5hbWU6ICdGYWtlJyxcbiAgICAgICAgICAgIGRldmljZU5hbWU6ICdDb21tb2RvcmUgNjQnLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZmlyc3RNYXRjaDogW3t9XSxcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IHNlc3Npb25Vcmw7XG4gICAgICAgIGxldCBzZXNzaW9uSWQ7XG5cbiAgICAgICAgYmVmb3JlRWFjaChhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgLy8gU3RhcnQgYSBzZXNzaW9uXG4gICAgICAgICAgbGV0IHt2YWx1ZX0gPSBhd2FpdCByZXF1ZXN0LnBvc3QoYmFzZVVybCwge1xuICAgICAgICAgICAganNvbjoge1xuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IHczY0NhcHMsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgc2Vzc2lvbklkID0gdmFsdWUuc2Vzc2lvbklkO1xuICAgICAgICAgIHNlc3Npb25VcmwgPSBgJHtiYXNlVXJsfS8ke3Nlc3Npb25JZH1gO1xuICAgICAgICB9KTtcblxuICAgICAgICBhZnRlckVhY2goYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIC8vIERlbGV0ZSB0aGUgc2Vzc2lvblxuICAgICAgICAgIGF3YWl0IHJlcXVlc3QuZGVsZXRlKHNlc3Npb25VcmwpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChgc2hvdWxkIHRocm93IDQwMCBCYWQgUGFyYW1ldGVycyBleGNlcHRpb24gaWYgdGhlIHBhcmFtZXRlcnMgYXJlIGJhZGAsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICBjb25zdCB7bWVzc2FnZSwgc3RhdHVzQ29kZX0gPSBhd2FpdCByZXF1ZXN0LnBvc3QoYCR7c2Vzc2lvblVybH0vYWN0aW9uc2AsIHtcbiAgICAgICAgICAgIGpzb246IHtcbiAgICAgICAgICAgICAgYmFkOiAncGFyYW1zJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZDtcbiAgICAgICAgICBtZXNzYWdlLnNob3VsZC5tYXRjaCgvUGFyYW1ldGVycyB3ZXJlIGluY29ycmVjdC8pO1xuICAgICAgICAgIHN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDQwMCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KGBzaG91bGQgdGhyb3cgNDA0IE5vdCBGb3VuZCBleGNlcHRpb24gaWYgdGhlIGNvbW1hbmQgaGFzbid0IGJlZW4gaW1wbGVtZW50ZWQgeWV0YCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHttZXNzYWdlLCBzdGF0dXNDb2RlfSA9IGF3YWl0IHJlcXVlc3QucG9zdChgJHtzZXNzaW9uVXJsfS9hY3Rpb25zYCwge1xuICAgICAgICAgICAganNvbjoge1xuICAgICAgICAgICAgICBhY3Rpb25zOiBbXSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZDtcbiAgICAgICAgICBtZXNzYWdlLnNob3VsZC5tYXRjaCgvTWV0aG9kIGhhcyBub3QgeWV0IGJlZW4gaW1wbGVtZW50ZWQvKTtcbiAgICAgICAgICBzdGF0dXNDb2RlLnNob3VsZC5lcXVhbCg0MDQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChgc2hvdWxkIHRocm93IDUwMCBVbmtub3duIEVycm9yIGlmIHRoZSBjb21tYW5kIHRocm93cyBhbiB1bmV4cGVjdGVkIGV4Y2VwdGlvbmAsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICBkcml2ZXIucGVyZm9ybUFjdGlvbnMgPSAoKSA9PiB7IHRocm93IG5ldyBFcnJvcihgRGlkbid0IHdvcmtgKTsgfTtcbiAgICAgICAgICBjb25zdCB7bWVzc2FnZSwgc3RhdHVzQ29kZX0gPSBhd2FpdCByZXF1ZXN0LnBvc3QoYCR7c2Vzc2lvblVybH0vYWN0aW9uc2AsIHtcbiAgICAgICAgICAgIGpzb246IHtcbiAgICAgICAgICAgICAgYWN0aW9uczogW10sXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWQ7XG4gICAgICAgICAgbWVzc2FnZS5zaG91bGQubWF0Y2goLzUwMFtcXHdcXFddKkRpZG4ndCB3b3JrLyk7XG4gICAgICAgICAgc3RhdHVzQ29kZS5zaG91bGQuZXF1YWwoNTAwKTtcbiAgICAgICAgICBkZWxldGUgZHJpdmVyLnBlcmZvcm1BY3Rpb25zO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdChgc2hvdWxkIGZhaWwgd2l0aCBhIDQwOCBlcnJvciBpZiBpdCB0aHJvd3MgYSBUaW1lb3V0RXJyb3IgZXhjZXB0aW9uYCwgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIHNpbm9uLnN0dWIoZHJpdmVyLCAnc2V0VXJsJywgKCkgPT4geyB0aHJvdyBuZXcgZXJyb3JzLlRpbWVvdXRFcnJvcjsgfSk7XG4gICAgICAgICAgbGV0IHtzdGF0dXNDb2RlfSA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgICAgdXJsOiBgJHtzZXNzaW9uVXJsfS91cmxgLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBqc29uOiB7XG4gICAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vJyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZDtcbiAgICAgICAgICBzdGF0dXNDb2RlLnNob3VsZC5lcXVhbCg0MDgpO1xuICAgICAgICAgIHNpbm9uLnJlc3RvcmUoZHJpdmVyLCAnc2V0VXJsJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KGBzaG91bGQgcGFzcyB3aXRoIDIwMCBIVFRQIHN0YXR1cyBjb2RlIGlmIHRoZSBjb21tYW5kIHJldHVybnMgYSB2YWx1ZWAsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICBkcml2ZXIucGVyZm9ybUFjdGlvbnMgPSAoYWN0aW9ucykgPT4gJ0l0IHdvcmtzICcgKyBhY3Rpb25zLmpvaW4oJycpO1xuICAgICAgICAgIGNvbnN0IHtzdGF0dXMsIHZhbHVlLCBzZXNzaW9uSWR9ID0gYXdhaXQgcmVxdWVzdC5wb3N0KGAke3Nlc3Npb25Vcmx9L2FjdGlvbnNgLCB7XG4gICAgICAgICAgICBqc29uOiB7XG4gICAgICAgICAgICAgIGFjdGlvbnM6IFsnYScsICdiJywgJ2MnXSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBzaG91bGQubm90LmV4aXN0KHNlc3Npb25JZCk7XG4gICAgICAgICAgc2hvdWxkLm5vdC5leGlzdChzdGF0dXMpO1xuICAgICAgICAgIHZhbHVlLnNob3VsZC5lcXVhbCgnSXQgd29ya3MgYWJjJyk7XG4gICAgICAgICAgZGVsZXRlIGRyaXZlci5wZXJmb3JtQWN0aW9ucztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGVzY3JpYmUoJ2p3cHJveHknLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgbGV0IHBvcnQgPSA1NjU2MjtcbiAgICAgICAgICBsZXQgc2VydmVyLCBqd3Byb3h5LCBhcHA7XG4gICAgICAgICAgYmVmb3JlRWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsZXQgcmVzID0gY3JlYXRlUHJveHlTZXJ2ZXIoc2Vzc2lvbklkLCBwb3J0KTtcbiAgICAgICAgICAgIHNlcnZlciA9IHJlcy5zZXJ2ZXI7XG4gICAgICAgICAgICBhcHAgPSByZXMuYXBwO1xuICAgICAgICAgICAgandwcm94eSA9IG5ldyBKV1Byb3h5KHtob3N0OiAnbG9jYWxob3N0JywgcG9ydH0pO1xuICAgICAgICAgICAgandwcm94eS5zZXNzaW9uSWQgPSBzZXNzaW9uSWQ7XG4gICAgICAgICAgICBkcml2ZXIucGVyZm9ybUFjdGlvbnMgPSBhc3luYyAoYWN0aW9ucykgPT4gYXdhaXQgandwcm94eS5jb21tYW5kKCcvcGVyZm9ybS1hY3Rpb25zJywgJ1BPU1QnLCBhY3Rpb25zKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGFmdGVyRWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZXJ2ZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIGRlbGV0ZSBkcml2ZXIucGVyZm9ybUFjdGlvbnM7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpdCgnc2hvdWxkIHdvcmsgaWYgYSBwcm94aWVkIHJlcXVlc3QgcmV0dXJucyBhIHJlc3BvbnNlIHdpdGggc3RhdHVzIDIwMCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGFkZEhhbmRsZXIoYXBwLCAncG9zdCcsICcvd2QvaHViL3Nlc3Npb24vOnNlc3Npb25JZC9wZXJmb3JtLWFjdGlvbnMnLCAocmVxLCByZXMpID0+IHtcbiAgICAgICAgICAgICAgcmVzLmpzb24oe1xuICAgICAgICAgICAgICAgIHNlc3Npb25JZDogcmVxLnBhcmFtcy5zZXNzaW9uSWQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHJlcS5ib2R5LFxuICAgICAgICAgICAgICAgIHN0YXR1czogMCxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3Qge3N0YXR1cywgdmFsdWUsIHNlc3Npb25JZH0gPSBhd2FpdCByZXF1ZXN0LnBvc3QoYCR7c2Vzc2lvblVybH0vYWN0aW9uc2AsIHtcbiAgICAgICAgICAgICAganNvbjoge1xuICAgICAgICAgICAgICAgIGFjdGlvbnM6IFsxLCAyLCAzXSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFsdWUuc2hvdWxkLmVxbChbMSwgMiwgM10pO1xuICAgICAgICAgICAgc2hvdWxkLm5vdC5leGlzdChzdGF0dXMpO1xuICAgICAgICAgICAgc2hvdWxkLm5vdC5leGlzdChzZXNzaW9uSWQpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaXQoJ3Nob3VsZCB3b3JrIGlmIGEgcHJveGllZCByZXF1ZXN0IHJldHVybnMgYSBNSlNPTldQIGVycm9yIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYWRkSGFuZGxlcihhcHAsICdwb3N0JywgJy93ZC9odWIvc2Vzc2lvbi86c2Vzc2lvbklkL3BlcmZvcm0tYWN0aW9ucycsIChyZXEsIHJlcykgPT4ge1xuICAgICAgICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICAgICAgICAgICAgc2Vzc2lvbklkLFxuICAgICAgICAgICAgICAgIHN0YXR1czogNixcbiAgICAgICAgICAgICAgICB2YWx1ZTogJ0EgcHJvYmxlbSBvY2N1cnJlZCcsXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCB7c3RhdHVzQ29kZSwgbWVzc2FnZX0gPSBhd2FpdCByZXF1ZXN0LnBvc3QoYCR7c2Vzc2lvblVybH0vYWN0aW9uc2AsIHtcbiAgICAgICAgICAgICAganNvbjoge1xuICAgICAgICAgICAgICAgIGFjdGlvbnM6IFsxLCAyLCAzXSxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWQ7XG4gICAgICAgICAgICBzdGF0dXNDb2RlLnNob3VsZC5lcXVhbChIVFRQU3RhdHVzQ29kZXMuTk9UX0ZPVU5EKTtcbiAgICAgICAgICAgIG1lc3NhZ2Uuc2hvdWxkLm1hdGNoKC9BIHByb2JsZW0gb2NjdXJyZWQvKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29tbWFuZHMgd2l0aCBubyByZXNwb25zZSB2YWx1ZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi9mb28vZm9yd2FyZCcsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgfSk7XG4gICAgICByZXMuc2hvdWxkLmVxbCh7XG4gICAgICAgIHN0YXR1czogMCxcbiAgICAgICAgdmFsdWU6IG51bGwsXG4gICAgICAgIHNlc3Npb25JZDogXCJmb29cIlxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGVtcHR5IHN0cmluZyByZXNwb25zZSB2YWx1ZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi9mb28vZWxlbWVudC9iYXIvdGV4dCcsXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGpzb246IHRydWUsXG4gICAgICB9KTtcbiAgICAgIHJlcy5zaG91bGQuZXFsKHtcbiAgICAgICAgc3RhdHVzOiAwLFxuICAgICAgICB2YWx1ZTogXCJcIixcbiAgICAgICAgc2Vzc2lvbklkOiBcImZvb1wiXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2VuZCA1MDAgcmVzcG9uc2UgYW5kIGFuIFVua25vd24gb2JqZWN0IGZvciByZWplY3RlZCBjb21tYW5kcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2Zvby9yZWZyZXNoJyxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IHRydWUsXG4gICAgICAgIHJlc29sdmVXaXRoRnVsbFJlc3BvbnNlOiB0cnVlLFxuICAgICAgICBzaW1wbGU6IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgcmVzLnN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDUwMCk7XG4gICAgICByZXMuYm9keS5zaG91bGQuZXFsKHtcbiAgICAgICAgc3RhdHVzOiAxMyxcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICBtZXNzYWdlOiAnQW4gdW5rbm93biBzZXJ2ZXItc2lkZSBlcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICd0aGUgY29tbWFuZC4gT3JpZ2luYWwgZXJyb3I6IFRvbyBGcmVzaCEnXG4gICAgICAgIH0sXG4gICAgICAgIHNlc3Npb25JZDogXCJmb29cIlxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCB0aHJvdyBVbmtub3duRXJyb3Igd2hlbiBrbm93bicsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uL2ZvbycsXG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGpzb246IHRydWUsXG4gICAgICAgIHJlc29sdmVXaXRoRnVsbFJlc3BvbnNlOiB0cnVlLFxuICAgICAgICBzaW1wbGU6IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgcmVzLnN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDQwNCk7XG4gICAgICByZXMuYm9keS5zaG91bGQuZXFsKHtcbiAgICAgICAgc3RhdHVzOiA2LFxuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIG1lc3NhZ2U6ICdBIHNlc3Npb24gaXMgZWl0aGVyIHRlcm1pbmF0ZWQgb3Igbm90IHN0YXJ0ZWQnXG4gICAgICAgIH0sXG4gICAgICAgIHNlc3Npb25JZDogXCJmb29cIlxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZXNzaW9uIElkcycsICgpID0+IHtcbiAgICBsZXQgZHJpdmVyID0gbmV3IEZha2VEcml2ZXIoKTtcbiAgICBsZXQgbWpzb253cFNlcnZlcjtcblxuICAgIGJlZm9yZShhc3luYyAoKSA9PiB7XG4gICAgICBtanNvbndwU2VydmVyID0gYXdhaXQgc2VydmVyKHJvdXRlQ29uZmlndXJpbmdGdW5jdGlvbihkcml2ZXIpLCA4MTgxKTtcbiAgICB9KTtcblxuICAgIGFmdGVyKGFzeW5jICgpID0+IHtcbiAgICAgIG1qc29ud3BTZXJ2ZXIuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgICBkcml2ZXIuc2Vzc2lvbklkID0gbnVsbDtcbiAgICB9KTtcblxuICAgIGl0KCdyZXR1cm5zIG51bGwgU2Vzc2lvbklkIGZvciBjb21tYW5kcyB3aXRob3V0IHNlc3Npb25JZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc3RhdHVzJyxcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAganNvbjogdHJ1ZSxcbiAgICAgIH0pO1xuXG4gICAgICBzaG91bGQuZXF1YWwocmVzLnNlc3Npb25JZCwgbnVsbCk7XG4gICAgfSk7XG5cbiAgICBpdCgncmVzcG9uZHMgd2l0aCB0aGUgc2FtZSBzZXNzaW9uIElEIGluIHRoZSByZXF1ZXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHNlc3Npb25JZCA9ICdWYWRlciBTZXNzaW9ucyc7XG4gICAgICBkcml2ZXIuc2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuXG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogYGh0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi8ke3Nlc3Npb25JZH0vdXJsYCxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IHt1cmw6ICdodHRwOi8vZ29vZ2xlLmNvbSd9XG4gICAgICB9KTtcblxuICAgICAgc2hvdWxkLmV4aXN0KHJlcy5zZXNzaW9uSWQpO1xuICAgICAgcmVzLnNlc3Npb25JZC5zaG91bGQuZXFsKHNlc3Npb25JZCk7XG4gICAgfSk7XG5cbiAgICBpdCgneWVsbHMgaWYgbm8gc2Vzc2lvbiBleGlzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgc2Vzc2lvbklkID0gJ1ZhZGVyIFNlc3Npb25zJztcblxuICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICB1cmw6IGBodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vJHtzZXNzaW9uSWR9L3VybGAsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBqc29uOiB7dXJsOiAnaHR0cDovL2dvb2dsZS5jb20nfSxcbiAgICAgICAgcmVzb2x2ZVdpdGhGdWxsUmVzcG9uc2U6IHRydWUsXG4gICAgICAgIHNpbXBsZTogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICByZXMuc3RhdHVzQ29kZS5zaG91bGQuZXF1YWwoNDA0KTtcbiAgICAgIHJlcy5ib2R5LnN0YXR1cy5zaG91bGQuZXF1YWwoNik7XG4gICAgICByZXMuYm9keS52YWx1ZS5tZXNzYWdlLnNob3VsZC5jb250YWluKCdzZXNzaW9uJyk7XG4gICAgfSk7XG5cbiAgICBpdCgneWVsbHMgaWYgaW52YWxpZCBzZXNzaW9uIGlzIHNlbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgc2Vzc2lvbklkID0gJ1ZhZGVyIFNlc3Npb25zJztcbiAgICAgIGRyaXZlci5zZXNzaW9uSWQgPSAncmVjZXNzaW9uJztcblxuICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICB1cmw6IGBodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vJHtzZXNzaW9uSWR9L3VybGAsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBqc29uOiB7dXJsOiAnaHR0cDovL2dvb2dsZS5jb20nfSxcbiAgICAgICAgcmVzb2x2ZVdpdGhGdWxsUmVzcG9uc2U6IHRydWUsXG4gICAgICAgIHNpbXBsZTogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICByZXMuc3RhdHVzQ29kZS5zaG91bGQuZXF1YWwoNDA0KTtcbiAgICAgIHJlcy5ib2R5LnN0YXR1cy5zaG91bGQuZXF1YWwoNik7XG4gICAgICByZXMuYm9keS52YWx1ZS5tZXNzYWdlLnNob3VsZC5jb250YWluKCdzZXNzaW9uJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgc2Vzc2lvbiBJRHMgaW4gZXJyb3IgcmVzcG9uc2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHNlc3Npb25JZCA9ICdWYWRlciBTZXNzaW9ucyc7XG4gICAgICBkcml2ZXIuc2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuXG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogYGh0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi8ke3Nlc3Npb25JZH0vcmVmcmVzaGAsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgICByZXNvbHZlV2l0aEZ1bGxSZXNwb25zZTogdHJ1ZSxcbiAgICAgICAgc2ltcGxlOiBmYWxzZVxuICAgICAgfSk7XG5cbiAgICAgIHJlcy5zdGF0dXNDb2RlLnNob3VsZC5lcXVhbCg1MDApO1xuICAgICAgcmVzLmJvZHkuc2hvdWxkLmVxbCh7XG4gICAgICAgIHN0YXR1czogMTMsXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgbWVzc2FnZTogJ0FuIHVua25vd24gc2VydmVyLXNpZGUgZXJyb3Igb2NjdXJyZWQgd2hpbGUgcHJvY2Vzc2luZyAnICtcbiAgICAgICAgICAgICAgICAgICAndGhlIGNvbW1hbmQuIE9yaWdpbmFsIGVycm9yOiBUb28gRnJlc2ghJ1xuICAgICAgICB9LFxuICAgICAgICBzZXNzaW9uSWRcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYSBuZXcgc2Vzc2lvbiBJRCBvbiBjcmVhdGUnLCBhc3luYyAoKSA9PiB7XG5cbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uJyxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IHtkZXNpcmVkQ2FwYWJpbGl0aWVzOiB7Z3JlZXRpbmc6ICdoZWxsbyd9LCByZXF1aXJlZENhcGFiaWxpdGllczoge3ZhbGVkaWN0aW9uOiAnYnllJ319XG4gICAgICB9KTtcblxuICAgICAgc2hvdWxkLmV4aXN0KHJlcy5zZXNzaW9uSWQpO1xuICAgICAgcmVzLnNlc3Npb25JZC5zaG91bGQuZXF1YWwoJzEyMzQnKTtcbiAgICAgIHJlcy52YWx1ZS5zaG91bGQuZXFsKHtncmVldGluZzogJ2hlbGxvJywgdmFsZWRpY3Rpb246ICdieWUnfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd2aWEgZHJpdmVycyBqc29ud3AgcHJveHknLCAoKSA9PiB7XG4gICAgbGV0IGRyaXZlcjtcbiAgICBsZXQgc2Vzc2lvbklkID0gJ2Zvbyc7XG4gICAgbGV0IG1qc29ud3BTZXJ2ZXI7XG5cbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIGRyaXZlciA9IG5ldyBGYWtlRHJpdmVyKCk7XG4gICAgICBkcml2ZXIuc2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuICAgICAgZHJpdmVyLnByb3h5QWN0aXZlID0gKCkgPT4geyByZXR1cm4gdHJ1ZTsgfTtcbiAgICAgIGRyaXZlci5jYW5Qcm94eSA9ICgpID0+IHsgcmV0dXJuIHRydWU7IH07XG5cbiAgICAgIG1qc29ud3BTZXJ2ZXIgPSBhd2FpdCBzZXJ2ZXIocm91dGVDb25maWd1cmluZ0Z1bmN0aW9uKGRyaXZlciksIDgxODEpO1xuICAgIH0pO1xuXG4gICAgYWZ0ZXJFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIG1qc29ud3BTZXJ2ZXIuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2l2ZSBhIG5pY2UgZXJyb3IgaWYgcHJveHlpbmcgaXMgc2V0IGJ1dCBubyBwcm94eSBmdW5jdGlvbiBleGlzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBkcml2ZXIuY2FuUHJveHkgPSAoKSA9PiB7IHJldHVybiBmYWxzZTsgfTtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiBgaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uLyR7c2Vzc2lvbklkfS91cmxgLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAganNvbjoge3VybDogJ2h0dHA6Ly9nb29nbGUuY29tJ30sXG4gICAgICAgIHJlc29sdmVXaXRoRnVsbFJlc3BvbnNlOiB0cnVlLFxuICAgICAgICBzaW1wbGU6IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgcmVzLnN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDUwMCk7XG4gICAgICByZXMuYm9keS5zaG91bGQuZXFsKHtcbiAgICAgICAgc3RhdHVzOiAxMyxcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICBtZXNzYWdlOiAnQW4gdW5rbm93biBzZXJ2ZXItc2lkZSBlcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nICcgK1xuICAgICAgICAgICAgICAgICAgICd0aGUgY29tbWFuZC4gT3JpZ2luYWwgZXJyb3I6IFRyeWluZyB0byBwcm94eSB0byBhIEpTT05XUCAnICtcbiAgICAgICAgICAgICAgICAgICAnc2VydmVyIGJ1dCBkcml2ZXIgaXMgdW5hYmxlIHRvIHByb3h5J1xuICAgICAgICB9LFxuICAgICAgICBzZXNzaW9uSWRcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwYXNzIG9uIGFueSBlcnJvcnMgaW4gcHJveHlpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBkcml2ZXIucHJveHlSZXFSZXMgPSBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImZvb1wiKTtcbiAgICAgIH07XG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogYGh0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi8ke3Nlc3Npb25JZH0vdXJsYCxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IHt1cmw6ICdodHRwOi8vZ29vZ2xlLmNvbSd9LFxuICAgICAgICByZXNvbHZlV2l0aEZ1bGxSZXNwb25zZTogdHJ1ZSxcbiAgICAgICAgc2ltcGxlOiBmYWxzZVxuICAgICAgfSk7XG5cbiAgICAgIHJlcy5zdGF0dXNDb2RlLnNob3VsZC5lcXVhbCg1MDApO1xuICAgICAgcmVzLmJvZHkuc2hvdWxkLmVxbCh7XG4gICAgICAgIHN0YXR1czogMTMsXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgbWVzc2FnZTogJ0FuIHVua25vd24gc2VydmVyLXNpZGUgZXJyb3Igb2NjdXJyZWQgd2hpbGUgcHJvY2Vzc2luZyAnICtcbiAgICAgICAgICAgICAgICAgICAndGhlIGNvbW1hbmQuIE9yaWdpbmFsIGVycm9yOiBDb3VsZCBub3QgcHJveHkuIFByb3h5ICcgK1xuICAgICAgICAgICAgICAgICAgICdlcnJvcjogZm9vJ1xuICAgICAgICB9LFxuICAgICAgICBzZXNzaW9uSWRcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhYmxlIHRvIHRocm93IFByb3h5UmVxdWVzdEVycm9yIGluIHByb3h5aW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgZHJpdmVyLnByb3h5UmVxUmVzID0gYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQganNvbndwID0ge3N0YXR1czogMzUsIHZhbHVlOiBcIk5vIHN1Y2ggY29udGV4dCBmb3VuZC5cIiwgc2Vzc2lvbklkOiBcImZvb1wifTtcbiAgICAgICAgdGhyb3cgIG5ldyBlcnJvcnMuUHJveHlSZXF1ZXN0RXJyb3IoYENvdWxkIG5vdCBwcm94eSBjb21tYW5kIHRvIHJlbW90ZSBzZXJ2ZXIuIGAsIGpzb253cCk7XG4gICAgICB9O1xuICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICB1cmw6IGBodHRwOi8vbG9jYWxob3N0OjgxODEvd2QvaHViL3Nlc3Npb24vJHtzZXNzaW9uSWR9L3VybGAsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBqc29uOiB7dXJsOiAnaHR0cDovL2dvb2dsZS5jb20nfSxcbiAgICAgICAgcmVzb2x2ZVdpdGhGdWxsUmVzcG9uc2U6IHRydWUsXG4gICAgICAgIHNpbXBsZTogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICByZXMuc3RhdHVzQ29kZS5zaG91bGQuZXF1YWwoNTAwKTtcbiAgICAgIHJlcy5ib2R5LnNob3VsZC5lcWwoe1xuICAgICAgICBzdGF0dXM6IDM1LFxuICAgICAgICBcInZhbHVlXCI6IHsgXCJtZXNzYWdlXCI6IFwiTm8gc3VjaCBjb250ZXh0IGZvdW5kLlwifSxcbiAgICAgICAgc2Vzc2lvbklkOiBcImZvb1wiXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbGV0IHRoZSBwcm94eSBoYW5kbGUgcmVxL3JlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGRyaXZlci5wcm94eVJlcVJlcyA9IGFzeW5jIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7Y3VzdG9tOiAnZGF0YSd9KTtcbiAgICAgIH07XG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogYGh0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi8ke3Nlc3Npb25JZH0vdXJsYCxcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGpzb246IHt1cmw6ICdodHRwOi8vZ29vZ2xlLmNvbSd9LFxuICAgICAgICByZXNvbHZlV2l0aEZ1bGxSZXNwb25zZTogdHJ1ZSxcbiAgICAgICAgc2ltcGxlOiBmYWxzZVxuICAgICAgfSk7XG5cbiAgICAgIHJlcy5zdGF0dXNDb2RlLnNob3VsZC5lcXVhbCgyMDApO1xuICAgICAgcmVzLmJvZHkuc2hvdWxkLmVxbCh7Y3VzdG9tOiAnZGF0YSd9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXZvaWQganNvbndwIHByb3h5aW5nIHdoZW4gcGF0aCBtYXRjaGVzIGF2b2lkYW5jZSBsaXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgZHJpdmVyLmdldFByb3h5QXZvaWRMaXN0ID0gKCkgPT4geyByZXR1cm4gW1snUE9TVCcsIG5ldyBSZWdFeHAoJ14vc2Vzc2lvbi9bXi9dKy91cmwkJyldXTsgfTtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiBgaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uLyR7c2Vzc2lvbklkfS91cmxgLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAganNvbjoge3VybDogJ2h0dHA6Ly9nb29nbGUuY29tJ30sXG4gICAgICAgIHJlc29sdmVXaXRoRnVsbFJlc3BvbnNlOiB0cnVlLFxuICAgICAgICBzaW1wbGU6IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgcmVzLnN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDIwMCk7XG4gICAgICByZXMuYm9keS5zaG91bGQuZXFsKHtcbiAgICAgICAgc3RhdHVzOiAwLFxuICAgICAgICB2YWx1ZTogXCJOYXZpZ2F0ZWQgdG86IGh0dHA6Ly9nb29nbGUuY29tXCIsXG4gICAgICAgIHNlc3Npb25JZFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZhaWwgaWYgYXZvaWQgcHJveHkgbGlzdCBpcyBtYWxmb3JtZWQgaW4gc29tZSB3YXknLCBhc3luYyAoKSA9PiB7XG4gICAgICBhc3luYyBmdW5jdGlvbiBiYWRQcm94eUF2b2lkYW5jZUxpc3QgKGxpc3QpIHtcbiAgICAgICAgZHJpdmVyLmdldFByb3h5QXZvaWRMaXN0ID0gKCkgPT4geyByZXR1cm4gbGlzdDsgfTtcbiAgICAgICAgbGV0IHJlcyA9IGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIHVybDogYGh0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc2Vzc2lvbi8ke3Nlc3Npb25JZH0vdXJsYCxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBqc29uOiB7dXJsOiAnaHR0cDovL2dvb2dsZS5jb20nfSxcbiAgICAgICAgICByZXNvbHZlV2l0aEZ1bGxSZXNwb25zZTogdHJ1ZSxcbiAgICAgICAgICBzaW1wbGU6IGZhbHNlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJlcy5zdGF0dXNDb2RlLnNob3VsZC5lcXVhbCg1MDApO1xuICAgICAgICByZXMuYm9keS5zdGF0dXMuc2hvdWxkLmVxdWFsKDEzKTtcbiAgICAgICAgcmVzLmJvZHkudmFsdWUubWVzc2FnZS5zaG91bGQuY29udGFpbihcInJveHlcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBsaXN0cyA9IFtcbiAgICAgICAgJ2ZvbycsXG4gICAgICAgIFtbJ2ZvbyddXSxcbiAgICAgICAgW1snQkFSJywgL2xvbC9dXSxcbiAgICAgICAgW1snR0VUJywgJ2ZvbyddXVxuICAgICAgXTtcbiAgICAgIGZvciAobGV0IGxpc3Qgb2YgbGlzdHMpIHtcbiAgICAgICAgYXdhaXQgYmFkUHJveHlBdm9pZGFuY2VMaXN0KGxpc3QpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhdm9pZCBwcm94eWluZyBub24tc2Vzc2lvbiBjb21tYW5kcyBldmVuIGlmIG5vdCBpbiB0aGUgbGlzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGRyaXZlci5nZXRQcm94eUF2b2lkTGlzdCA9ICgpID0+IHsgcmV0dXJuIFtbJ1BPU1QnLCBuZXcgUmVnRXhwKCcnKV1dOyB9O1xuXG4gICAgICBsZXQgcmVzID0gYXdhaXQgcmVxdWVzdCh7XG4gICAgICAgIHVybDogYGh0dHA6Ly9sb2NhbGhvc3Q6ODE4MS93ZC9odWIvc3RhdHVzYCxcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAganNvbjogdHJ1ZSxcbiAgICAgICAgcmVzb2x2ZVdpdGhGdWxsUmVzcG9uc2U6IHRydWUsXG4gICAgICAgIHNpbXBsZTogZmFsc2VcbiAgICAgIH0pO1xuXG4gICAgICByZXMuc3RhdHVzQ29kZS5zaG91bGQuZXF1YWwoMjAwKTtcbiAgICAgIHJlcy5ib2R5LnNob3VsZC5lcWwoe1xuICAgICAgICBzdGF0dXM6IDAsXG4gICAgICAgIHZhbHVlOiBcIkknbSBmaW5lXCIsXG4gICAgICAgIHNlc3Npb25JZDogbnVsbFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGF2b2lkIHByb3h5aW5nIGRlbGV0ZVNlc3Npb24gY29tbWFuZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBkcml2ZXIuZ2V0UHJveHlBdm9pZExpc3QgPSAoKSA9PiB7IHJldHVybiBbWydQT1NUJywgbmV3IFJlZ0V4cCgnJyldXTsgfTtcblxuICAgICAgZHJpdmVyLnNlc3Npb25JZC5zaG91bGQuZXF1YWwoc2Vzc2lvbklkKTtcbiAgICAgIGxldCByZXMgPSBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgdXJsOiBgaHR0cDovL2xvY2FsaG9zdDo4MTgxL3dkL2h1Yi9zZXNzaW9uLyR7c2Vzc2lvbklkfWAsXG4gICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgIGpzb246IHRydWUsXG4gICAgICAgIHJlc29sdmVXaXRoRnVsbFJlc3BvbnNlOiB0cnVlLFxuICAgICAgICBzaW1wbGU6IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgcmVzLnN0YXR1c0NvZGUuc2hvdWxkLmVxdWFsKDIwMCk7XG4gICAgICBzaG91bGQubm90LmV4aXN0KGRyaXZlci5zZXNzaW9uSWQpO1xuICAgICAgZHJpdmVyLmp3cFByb3h5QWN0aXZlLnNob3VsZC5iZS5mYWxzZTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
